Retrieving R from files... Got users... Got ratings... Got movies... Got R.
Removing columns...Removing rows...R Density: 0.00540, ratings: 20000263, users: 138493, items: 26744, features: 20, nyms: 1
Splitting dataset with test_ratio=0.1
Removed 0 rows from test_R due to too few training samples.
Training Density: 0.00486, ratings: 18000237, users: 138493, items: 26744, features: 20, nyms: 1
Pre-processing time: 21.538

Running weighted alternating least squares? True

Itt/Users/Chng		Timings (Rtilde, P, Alsqr V)	Iter	Delta
 0 /      10 /      10	  0.000 /   0.003 /   1.356	1	1.57e-05
 0 /     100 /     100	  0.000 /   0.000 /   5.037	1	8.80e-07
 0 /    1000 /    1000	  0.000 /   0.001 /   8.625	1	4.71e-07
 0 /   10000 /   10000	  0.000 /   0.005 /  14.153	1	2.78e-07
 0 /  100000 /  100000	  0.000 /   0.055 /  21.455	1	2.51e-08
 0 /  138493 /  138493	  0.000 /   0.075 /  21.931	1	1.81e-08
--- Nym distribution (MSE/rating): 138493 (0.883), Total error: 0.883.
Main-loop time: 76.798

--> Splitting 1 nym(s) (distances: 1), increasing to 2. 138493 (100%) users affected. (Rtilde density: 0.985)
 0 /      20 /       5	  0.001 /   0.006 /  23.573	1	6.45e-08
 0 /     200 /      22	  0.002 /   0.005 /  25.202	1	5.24e-08
 0 /    2000 /      89	  0.006 /   0.013 /  24.920	1	4.00e-08
 0 /   20000 /    1270	  0.022 /   0.069 /  23.728	1	1.50e-08
 0 /  138493 /   11567	  0.164 /   0.632 /  23.690	1	8.82e-09
 1 /  138493 /    6935	  0.153 /   0.560 /  23.054	1	2.30e-09
 2 /  138493 /    6726	  0.145 /   0.534 /  24.430	1	2.51e-09
 3 /  138493 /    5633	  0.145 /   0.538 /  23.747	1	2.50e-09
 4 /  138493 /    4498	  0.145 /   0.532 /  24.095	1	2.39e-09
 5 /  138493 /    3529	  0.145 /   0.535 /  22.625	1	2.64e-09
 6 /  138493 /    2946	  0.145 /   0.535 /  23.876	1	2.81e-09
 7 /  138493 /    2368	  0.145 /   0.534 /  24.372	1	2.81e-09
 8 /  138493 /    1877	  0.145 /   0.533 /  22.929	1	2.86e-09
 9 /  138493 /    1499	  0.145 /   0.530 /  23.334	1	2.88e-09
--- Nym distribution (MSE/rating): 91085 (0.714), 47408 (0.878), Total error: 0.782.
Main-loop time: 350.869

--> Splitting 2 nym(s) (distances: 1494375, 1494375), increasing to 4. 138493 (100%) users affected. (Rtilde density: 0.878)
 0 /      40 /      17	  0.001 /   0.007 /  23.878	1	3.08e-09
 0 /     400 /      56	  0.002 /   0.006 /  24.147	1	3.51e-09
 0 /    4000 /     350	  0.009 /   0.023 /  26.618	1	4.17e-09
 0 /   40000 /    3965	  0.033 /   0.120 /  24.054	1	4.71e-09
 0 /  138493 /   18071	  0.141 /   0.451 /  30.065	1	5.40e-09
 1 /  138493 /    9692	  0.132 /   0.546 /  25.286	1	5.27e-09
 2 /  138493 /    7141	  0.144 /   0.648 /  28.884	1	5.32e-09
 3 /  138493 /    5196	  0.123 /   0.515 /  24.849	1	5.28e-09
 4 /  138493 /    3634	  0.124 /   0.515 /  27.071	1	5.49e-09
 5 /  138493 /    2355	  0.129 /   0.612 /  23.561	1	5.45e-09
 6 /  138493 /    1574	  0.144 /   0.661 /  25.206	1	5.34e-09
 7 /  138493 /    1041	  0.124 /   0.516 /  24.838	1	5.48e-09
--- Nym distribution (MSE/rating): 57882 (0.680), 37010 (0.766), 34572 (0.655), 9029 (1.088), Total error: 0.734.
Main-loop time: 325.797

--> Splitting 4 nym(s) (distances: 897017, 251541, 910640, 251541), increasing to 8. 138493 (100%) users affected. (Rtilde density: 0.743)
 0 /      80 /      30	  0.001 /   0.008 /  23.963	1	6.03e-09
 0 /     800 /      99	  0.003 /   0.009 /  24.853	1	6.28e-09
 0 /    8000 /     490	  0.010 /   0.031 /  24.018	1	6.85e-09
 0 /   80000 /    4747	  0.096 /   0.290 /  25.843	1	7.66e-09
 0 /  138493 /   10609	  0.092 /   0.255 /  23.326	1	8.19e-09
 1 /  138493 /   11303	  0.186 /   0.627 /  23.223	1	8.24e-09
 2 /  138493 /   10577	  0.175 /   0.599 /  24.014	1	8.46e-09
 3 /  138493 /    9656	  0.170 /   0.582 /  25.713	1	8.56e-09
 4 /  138493 /    8596	  0.179 /   0.652 /  26.950	1	8.83e-09
 5 /  138493 /    7424	  0.215 /   0.758 /  26.268	1	8.95e-09
 6 /  138493 /    6196	  0.214 /   0.733 /  23.360	1	8.92e-09
 7 /  138493 /    5261	  0.176 /   0.626 /  25.709	1	8.85e-09
 8 /  138493 /    4365	  0.175 /   0.607 /  25.343	1	9.06e-09
 9 /  138493 /    3902	  0.171 /   0.579 /  23.611	1	9.17e-09
--- Nym distribution (MSE/rating): 31689 (0.601), 23233 (0.692), 26011 (0.610), 8518 (0.928), 17906 (0.691), 12630 (0.793), 11889 (0.814), 6617 (1.074), Total error: 0.700.
Main-loop time: 373.690

--> Splitting 8 nym(s) (distances: 251692, 208197, 675959, 208197, 551366, 251692, 675959, 551366), increasing to 16. 138493 (100%) users affected. (Rtilde density: 0.601)
 0 /     160 /      74	  0.001 /   0.006 /  24.209	1	1.11e-08
 0 /    1600 /     171	  0.006 /   0.016 /  25.127	1	1.12e-08
 0 /   16000 /    1038	  0.047 /   0.095 /  25.374	1	1.18e-08
 0 /  138493 /    8859	  0.297 /   0.762 /  23.624	1	1.45e-08
 1 /  138493 /    8077	  0.330 /   0.850 /  24.323	1	1.41e-08
 2 /  138493 /    7586	  0.318 /   0.815 /  24.231	1	1.37e-08
 3 /  138493 /    7224	  0.330 /   0.831 /  23.739	1	1.39e-08
 4 /  138493 /    6515	  0.318 /   0.817 /  24.385	1	1.38e-08
 5 /  138493 /    5817	  0.312 /   0.811 /  24.168	1	1.40e-08
 6 /  138493 /    4972	  0.314 /   0.813 /  24.983	1	1.42e-08
 7 /  138493 /    4521	  0.313 /   0.814 /  24.077	1	1.45e-08
 8 /  138493 /    3992	  0.318 /   0.812 /  24.504	1	1.45e-08
 9 /  138493 /    3500	  0.318 /   0.815 /  23.426	1	1.44e-08
--- Nym distribution (MSE/rating): 21898 (0.579), 15200 (0.659), 19677 (0.580), 6783 (0.843), 16243 (0.644), 10696 (0.750), 11138 (0.759), 5951 (0.969), 5930 (0.692), 9177 (0.730), 4719 (0.777), 1508 (1.075), 2542 (0.886), 2753 (0.805), 3465 (0.649), 813 (1.317), Total error: 0.680.
Main-loop time: 348.048

Doubling stopped. Running last pass.
 0 /  138493 /    3266	  0.319 /   0.806 /  24.027	1	1.47e-08
 1 /  138493 /    3142	  0.319 /   0.814 /  24.091	1	1.48e-08
 2 /  138493 /    2997	  0.317 /   0.811 /  23.786	1	1.51e-08
 3 /  138493 /    2856	  0.316 /   0.816 /  24.369	1	1.50e-08
 4 /  138493 /    2538	  0.312 /   0.815 /  24.385	1	1.53e-08
 5 /  138493 /    2332	  0.311 /   0.809 /  25.304	1	1.54e-08
 6 /  138493 /    2207	  0.313 /   0.813 /  23.928	1	1.56e-08
 7 /  138493 /    2006	  0.312 /   0.811 /  24.451	1	1.56e-08
 8 /  138493 /    1871	  0.313 /   0.810 /  24.186	1	1.57e-08
 9 /  138493 /    1791	  0.312 /   0.810 /  24.765	1	1.57e-08
--- Nym distribution (MSE/rating): 20065 (0.577), 13224 (0.647), 16644 (0.549), 6551 (0.827), 15290 (0.640), 10429 (0.739), 10963 (0.737), 5756 (0.966), 7376 (0.698), 10811 (0.716), 8251 (0.689), 1994 (1.023), 3178 (0.895), 3226 (0.828), 3872 (0.649), 863 (1.337), Total error: 0.675.
Main-loop time: 271.111

Maximum number of nyms of 16 reached without reaching error tolerance (0.010).
Total time taken: 1750.314

Factorisation RMSE: 0.821576
Prediction RMSE: 0.853461
moving output to 'output/2018-04-01T12:49:15'