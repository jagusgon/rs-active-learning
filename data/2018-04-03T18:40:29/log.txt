Loading R from "Data/netflix_ratings.npz" ... Got R.
Loading original_rows from "Data/netflix_orig_user_ids.npy" ... Got original_rows.
Loading original_cols from "Data/netflix_orig_movie_ids.npy" ... Got original_cols.
R Density: 0.01178, ratings: 100480507, users: 480189, items: 17770, features: 20, nyms: 1
Splitting dataset with test_ratio=0.1
Removed 4113 rows from test_R due to too few training samples.
Training Density: 0.01060, ratings: 90432457, users: 480189, items: 17770, features: 20, nyms: 1
Pre-processing time: 92.158

Running weighted alternating least squares? True

Choose platform:
[0] <pyopencl.Platform 'Intel Gen OCL Driver' at 0x7fcc8c657ae0>
Choice [0]:Set the environment variable PYOPENCL_CTX='' to avoid being asked again.
Itt/Users/Chng		Timings (Rtilde, P, Alsqr V)	Iter	Delta
 0 /      10 /      10	  0.000 /   0.015 /   1.125	1	4.11e-05
 0 /     100 /     100	  0.000 /   0.000 /   3.983	1	6.68e-08
 0 /    1000 /    1000	  0.000 /   0.001 /   9.013	1	6.42e-08
 0 /   10000 /   10000	  0.000 /   0.005 /  15.468	1	4.59e-08
 0 /  100000 /  100000	  0.000 /   0.070 /  16.273	1	1.12e-09
 0 /  480189 /  480189	  0.000 /   0.292 /  16.273	1	4.21e-10
--- Nym distribution (MSE/rating): 480189 (1.022), Total error: 1.022.
Main-loop time: 81.142

--> Splitting 1 nym(s) (distances: 1), increasing to 2. 480189 (100%) users affected. (Rtilde density: 1.000)
 0 /      20 /      14	  0.001 /   0.013 /  16.422	1	1.18e-09
 0 /     200 /      39	  0.003 /   0.010 /  16.186	1	1.37e-09
 0 /    2000 /     321	  0.008 /   0.020 /  16.507	1	1.63e-09
 0 /   20000 /    3910	  0.033 /   0.109 /  17.240	1	6.64e-09
 0 /  200000 /   37690	  0.310 /   1.004 /  17.432	1	1.01e-08
 0 /  480189 /   99666	  0.488 /   1.622 /  20.682	1	3.36e-09
 1 /  480189 /   27007	  0.877 /   2.850 /  19.646	1	3.07e-09
 2 /  480189 /   35180	  0.897 /   2.891 /  19.090	1	2.62e-09
 3 /  480189 /   30817	  0.871 /   2.747 /  20.427	1	2.38e-09
 4 /  480189 /   19795	  0.871 /   2.755 /  18.364	1	2.20e-09
 5 /  480189 /   13265	  0.908 /   2.909 /  17.488	1	2.15e-09
 6 /  480189 /    8840	  0.875 /   2.784 /  16.400	1	2.11e-09
 7 /  480189 /    5910	  0.884 /   2.781 /  17.072	1	2.09e-09
 8 /  480189 /    3902	  0.862 /   2.768 /  16.069	1	2.05e-09
--- Nym distribution (MSE/rating): 236523 (0.957), 243666 (0.843), Total error: 0.906.
Main-loop time: 333.981

--> Splitting 2 nym(s) (distances: 1731329, 1731329), increasing to 4. 480189 (100%) users affected. (Rtilde density: 1.000)
 0 /      40 /      15	  0.002 /   0.015 /  16.419	1	2.21e-09
 0 /     400 /      60	  0.004 /   0.013 /  16.748	1	2.49e-09
 0 /    4000 /     396	  0.030 /   0.054 /  16.226	1	4.08e-09
 0 /   40000 /    3915	  0.054 /   0.200 /  15.175	1	5.87e-09
 0 /  400000 /   51271	  0.540 /   2.010 /  17.245	1	6.74e-09
 0 /  480189 /   66751	  0.157 /   0.499 /  15.952	1	6.54e-09
 1 /  480189 /   36170	  0.729 /   2.662 /  16.231	1	5.80e-09
 2 /  480189 /   27954	  0.743 /   2.648 /  15.788	1	5.34e-09
 3 /  480189 /   22828	  0.737 /   2.650 /  21.970	1	5.11e-09
 4 /  480189 /   19698	  0.839 /   2.991 /  16.962	1	4.94e-09
 5 /  480189 /   18894	  0.739 /   2.706 /  16.178	1	4.89e-09
 6 /  480189 /   20529	  0.735 /   2.649 /  16.501	1	4.73e-09
 7 /  480189 /   22712	  0.740 /   2.643 /  16.642	1	4.72e-09
 8 /  480189 /   23602	  0.726 /   2.683 /  16.387	1	4.80e-09
 9 /  480189 /   21006	  0.726 /   2.681 /  15.286	1	4.73e-09
--- Nym distribution (MSE/rating): 127058 (0.848), 172009 (0.819), 76135 (0.996), 104987 (0.749), Total error: 0.847.
Main-loop time: 344.958

--> Splitting 4 nym(s) (distances: 1848462, 498462, 944889, 498462), increasing to 8. 480189 (100%) users affected. (Rtilde density: 1.000)
 0 /      80 /      42	  0.002 /   0.018 /  16.226	1	5.14e-09
 0 /     800 /     106	  0.004 /   0.015 /  17.441	1	5.20e-09
 0 /    8000 /     822	  0.018 /   0.052 /  18.022	1	6.73e-09
 0 /   80000 /    8417	  0.146 /   0.479 /  16.097	1	9.96e-09
 0 /  480189 /   65077	  0.831 /   2.465 /  16.982	1	1.34e-08
 1 /  480189 /   55166	  0.987 /   2.941 /  17.239	1	1.43e-08
 2 /  480189 /   53180	  1.003 /   2.940 /  17.585	1	1.48e-08
 3 /  480189 /   49354	  1.000 /   2.930 /  16.911	1	1.47e-08
 4 /  480189 /   41151	  0.999 /   2.950 /  17.959	1	1.45e-08
 5 /  480189 /   30915	  1.003 /   2.966 /  18.273	1	1.39e-08
 6 /  480189 /   23928	  1.015 /   3.167 /  20.646	1	1.36e-08
 7 /  480189 /   18876	  1.046 /   2.991 /  20.786	1	1.33e-08
 8 /  480189 /   14596	  1.041 /   3.201 /  18.503	1	1.32e-08
 9 /  480189 /   11729	  0.995 /   2.945 /  17.330	1	1.29e-08
--- Nym distribution (MSE/rating): 77218 (0.794), 79147 (0.763), 39370 (0.990), 72741 (0.740), 40904 (0.881), 65682 (0.802), 61995 (0.854), 43132 (0.639), Total error: 0.807.
Main-loop time: 354.774

Doubling stopped. Running last pass.
 0 /  480189 /    9767	  1.051 /   3.202 /  17.232	1	1.29e-08
 1 /  480189 /    8650	  0.989 /   2.940 /  16.847	1	1.27e-08
 2 /  480189 /    7361	  0.991 /   2.936 /  16.611	1	1.27e-08
 3 /  480189 /    6629	  1.002 /   2.936 /  16.444	1	1.27e-08
 4 /  480189 /    6104	  1.005 /   2.931 /  16.838	1	1.28e-08
 5 /  480189 /    5695	  1.077 /   3.171 /  16.588	1	1.26e-08
 6 /  480189 /    5325	  0.999 /   2.931 /  16.744	1	1.25e-08
 7 /  480189 /    4932	  0.990 /   2.942 /  16.988	1	1.25e-08
 8 /  480189 /    4816	  1.003 /   2.963 /  16.683	1	1.24e-08
 9 /  480189 /    4788	  1.002 /   2.941 /  15.959	1	1.24e-08
--- Nym distribution (MSE/rating): 70211 (0.798), 79417 (0.761), 29055 (1.049), 69195 (0.746), 42349 (0.879), 75492 (0.798), 66532 (0.848), 47938 (0.652), Total error: 0.806.
Main-loop time: 253.658

Maximum number of nyms of 8 reached without reaching error tolerance (0.010).
Total time taken: 1379.715

Factorisation RMSE: 0.897727
Prediction RMSE: 0.907384
